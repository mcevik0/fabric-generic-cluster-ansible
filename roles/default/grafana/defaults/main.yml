---
# defaults file for grafana

# Docker image and version
grafana_image: "grafana/grafana"
grafana_version: "10.2.3"

# Port configuration
grafana_port: 3000

# Directory configuration
grafana_data_dir: /var/lib/grafana
grafana_config_dir: /etc/grafana
grafana_dashboards_dir: /var/lib/grafana/dashboards

# Admin credentials
grafana_admin_user: admin
grafana_admin_password: admin  # CHANGE THIS IN PRODUCTION!

# Prometheus datasource configuration
# Use ansible_host so Grafana container can reach Prometheus on the host
grafana_prometheus_url: "http://{{ ansible_host }}:9090"
grafana_prometheus_name: "Prometheus"

# Datasource placeholder patterns found in downloaded dashboards.
# These are replaced with the actual datasource name after download.
grafana_datasource_placeholders:
  - regexp: '\$\{DS_PROMETHEUS\}'
    replace: "{{ grafana_prometheus_name }}"
  - regexp: '\$\{DS_PROMETHEUS_DATASOURCE\}'
    replace: "{{ grafana_prometheus_name }}"
  - regexp: '"datasource": "Prometheus"'
    replace: '"datasource": "{{ grafana_prometheus_name }}"'

# Plugins to install
grafana_plugins: []

# Pre-built dashboards to install
# node-exporter-full fetched from Grafana.com (latest revision auto-resolved)
# cadvisor dashboard is custom-built and shipped with the role (uses exact label names)
grafana_install_dashboards: true
grafana_dashboards:
  - name: "node-exporter-full"
    id: 1860
grafana_local_dashboards:
  - name: "cadvisor-container-metrics"
    src: "cadvisor-dashboard.json"

# Firewall configuration
grafana_configure_firewall: true
grafana_firewall_zone: "public"
